<?xml version="1.0" ?><jasbro.game.world.customContent.WorldEvent><id>dungeonCaptureMonster</id><triggers><jasbro.game.world.customContent.Trigger><requirement class="jasbro.game.world.customContent.requirements.AndRequirement"><requirements><jasbro.game.world.customContent.requirements.ActivityRequirement><activityType>EXPLORE</activityType></jasbro.game.world.customContent.requirements.ActivityRequirement><jasbro.game.world.customContent.requirements.AttributeRequirement><attributeType class="jasbro.game.character.attributes.EssentialAttributes">HEALTH</attributeType><amount>40</amount><comparison>GREATERTHAN</comparison></jasbro.game.world.customContent.requirements.AttributeRequirement></requirements></requirement><triggerType>ACTIVITYFINISHED</triggerType></jasbro.game.world.customContent.Trigger></triggers><effects><jasbro.game.world.customContent.effects.WorldEventEffectContainer><subEffects><jasbro.game.world.customContent.effects.WorldEventProtectCharacter><target>character</target></jasbro.game.world.customContent.effects.WorldEventProtectCharacter><jasbro.game.world.customContent.effects.WorldEventCode><code>for (ComplexEnemy enemy : activity.defeatedEnemies.toArray()) {
  enemyChar = CharacterSpawner.create(enemy.getCharacterBaseId(), CharacterType.SLAVE);

  if (enemyChar != null) {
    break;
  }
}</code><displayHeight>1</displayHeight></jasbro.game.world.customContent.effects.WorldEventCode><jasbro.game.world.customContent.effects.WorldEventCondition><subEffects><jasbro.game.world.customContent.effects.WorldEventEffectContainer><subEffects><jasbro.game.world.customContent.effects.WorldEventCode><code>options = new ArrayList();
options.add(new SelectionData(1, "Leave it."));
options.add(new SelectionData(2, "Capture it!", "Be careful, this is extremely dangerous for your character."));
image = ImageUtil.getInstance().getImageDataByTag(ImageTag.STANDARD, character);
image2 = ImageUtil.getInstance().getImageDataByTag(ImageTag.HURT, enemyChar);
selectedOption = new SelectionScreen().select(options, image, null, character.getBackground(), "The defeated " + enemyChar.name + " lies unconsciously on the dungeon floor. " + character.name + " could try to drag it back to town, to capture it. But other monsters are bound to show up if you do this.");
selected = selectedOption.getSelectionObject();</code><displayHeight>1</displayHeight></jasbro.game.world.customContent.effects.WorldEventCode><jasbro.game.world.customContent.effects.WorldEventCondition><subEffects><jasbro.game.world.customContent.effects.WorldEventEffectContainer><subEffects><jasbro.game.world.customContent.effects.WorldEventCode><code>Battle battle = new Battle();
battle.getSideA().add(character);
monsterA = CharacterSpawner.spawnEnemy(activity.getEnemySpawnLocation());
monsterB = CharacterSpawner.spawnEnemy(activity.getEnemySpawnLocation());
monsterC = CharacterSpawner.spawnEnemy(activity.getEnemySpawnLocation());
battle.getSideB().add(monsterA);
battle.getSideB().add(monsterB);
battle.getSideB().add(monsterC);
monsterString = TextUtil.getInstance().listCharacters(battle.getSideB());
do {
    battle.doRound();
} 
while (!battle.isOver());</code><displayHeight>2</displayHeight></jasbro.game.world.customContent.effects.WorldEventCode><jasbro.game.world.customContent.effects.WorldEventSimpleMessage><message>As &lt;c.name&gt; drags the unconscious &lt;enemyChar.name&gt; &lt;c.heshe&gt; is suddenly surrounded by a whole pack of monsters. This is going to be tough!

&lt;battle.combatText&gt;</message><images><jasbro.game.world.customContent.ImageSelection><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>FIGHT</jasbro.gui.pictures.ImageTag></imageTags><background>false</background><target>character</target></jasbro.game.world.customContent.ImageSelection><jasbro.game.world.customContent.ImageSelection><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>FIGHT</jasbro.gui.pictures.ImageTag></imageTags><background>false</background><target>monsterA</target></jasbro.game.world.customContent.ImageSelection><jasbro.game.world.customContent.ImageSelection><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>FIGHT</jasbro.gui.pictures.ImageTag></imageTags><background>false</background><target>monsterB</target></jasbro.game.world.customContent.ImageSelection><jasbro.game.world.customContent.ImageSelection><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>FIGHT</jasbro.gui.pictures.ImageTag></imageTags><background>false</background><target>monsterC</target></jasbro.game.world.customContent.ImageSelection></images><background><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>STANDARD</jasbro.gui.pictures.ImageTag></imageTags><background>true</background><target>character</target></background><importantMessage>true</importantMessage></jasbro.game.world.customContent.effects.WorldEventSimpleMessage><jasbro.game.world.customContent.effects.WorldEventCondition><subEffects><jasbro.game.world.customContent.effects.WorldEventEffectContainer><subEffects><jasbro.game.world.customContent.effects.WorldEventCode><code>data.characters.add(enemyChar);
people = characters;
people.add(enemyChar);</code><displayHeight>1</displayHeight></jasbro.game.world.customContent.effects.WorldEventCode><jasbro.game.world.customContent.effects.WorldEventSimpleMessage><message>Victory! &lt;c.name&gt; manages to drag the still unconscious &lt;c2.name&gt; back home. Now begins the tedious work of training your new acquisition.</message><images><jasbro.game.world.customContent.ImageSelection><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>VICTORIOUS</jasbro.gui.pictures.ImageTag></imageTags><background>false</background><target>character</target></jasbro.game.world.customContent.ImageSelection><jasbro.game.world.customContent.ImageSelection><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>STANDARD</jasbro.gui.pictures.ImageTag></imageTags><background>false</background><target>enemyChar</target></jasbro.game.world.customContent.ImageSelection></images><background><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>STANDARD</jasbro.gui.pictures.ImageTag></imageTags><background>true</background><target>character</target></background><importantMessage>true</importantMessage></jasbro.game.world.customContent.effects.WorldEventSimpleMessage></subEffects></jasbro.game.world.customContent.effects.WorldEventEffectContainer><jasbro.game.world.customContent.effects.WorldEventEffectContainer><subEffects><jasbro.game.world.customContent.effects.WorldEventSimpleMessage><message>&lt;c.name&gt; was captured.</message><images></images><background><imageLocation>LOCAL</imageLocation><imageTags><jasbro.gui.pictures.ImageTag>STANDARD</jasbro.gui.pictures.ImageTag></imageTags><background>true</background><target>character</target></background><importantMessage>true</importantMessage></jasbro.game.world.customContent.effects.WorldEventSimpleMessage><jasbro.game.world.customContent.effects.WorldEventCallAnotherEvent><eventId>dungeonCharacterCaptured</eventId></jasbro.game.world.customContent.effects.WorldEventCallAnotherEvent></subEffects></jasbro.game.world.customContent.effects.WorldEventEffectContainer></subEffects><requirement class="jasbro.game.world.customContent.requirements.AttributeRequirement"><attributeType class="jasbro.game.character.attributes.EssentialAttributes">HEALTH</attributeType><amount>0</amount><comparison>GREATERTHAN</comparison></requirement></jasbro.game.world.customContent.effects.WorldEventCondition></subEffects></jasbro.game.world.customContent.effects.WorldEventEffectContainer></subEffects><requirement class="jasbro.game.world.customContent.requirements.CodeRequirement"><code>return selected == 2;</code></requirement></jasbro.game.world.customContent.effects.WorldEventCondition></subEffects></jasbro.game.world.customContent.effects.WorldEventEffectContainer></subEffects><requirement class="jasbro.game.world.customContent.requirements.CodeRequirement"><code>return enemyChar != null;</code></requirement></jasbro.game.world.customContent.effects.WorldEventCondition></subEffects></jasbro.game.world.customContent.effects.WorldEventEffectContainer></effects></jasbro.game.world.customContent.WorldEvent>